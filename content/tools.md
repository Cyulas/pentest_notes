# Tools
List of commonly used tools and the processes of using them.

- [Tools](#tools)
  - [BurpSuite](#burpsuite)
  - [Dirbuster](#dirbuster)
  - [Ffuf](#ffuf)
  - [GoBuster](#gobuster)
  - [Hashcat](#hashcat)
  - [Host](#host)
  - [Metasploit](#metasploit)
  - [Msfvenom](#msfvenom)
  - [Netcat](#netcat)
  - [NMAP](#nmap)
    - [Basic Scanning](#basic-scanning)
    - [Port Scan from a File](#port-scan-from-a-file)
  - [Socat](#socat)
  - [TCPDump](#tcpdump)
  - [TShark](#tshark)
  - [Wireshark](#wireshark)


## BurpSuite
## Dirbuster
## Ffuf
## GoBuster
## Hashcat
## Host
## Metasploit
## Msfvenom
## Netcat
## NMAP
### Basic Scanning
nmap -sn <ip range>
Start with a ping scan (-sn flag) with the ip range to identify which machines are active within the IP range. 
It will not do any port enumeration. Ports 80 and 443 are pinged and target may send response when running without sudo. Conducts 3 way handshake.
When running as sudo also sends an ICMP packet and a timestamp request. example nmap -sn 192.168.128.1-254


### Port Scan from a File
Nmap –p80 -iL <.file-name>
Nmap scan of port (-p) 80 from file (-iL) file name.
Example: nmap –p80 –iL scan-results.txt
![alt text](image-2.png)


Can use grep 'scan report' to filter out unnecessary stuff and just get the IPs found
sudo nmap -sn 192.168.128.1-254 | grep 'scan report'
![alt text](image-1.png)

For additional filtering, use the cut command to just print the IP addresses
    • sudo nmap -sn 192.168.128.1-254 | grep 'scan report' | cut -d " " -f 5
        ○ Using the example output from above, we can cut so only the IP addresses are listed. This would be handy for outputting the IPs to a file. 

cut -d " " - cut output (d) delimiter by spaces (" "). The field (f) that has the info we want (the IP address) is in the 5th field, counting left to right.

![nmap with -sn](image.png)



## Socat
## TCPDump
## TShark
TShark is a commandline tool that can perform packet analysis. Similar functionality to Wireshark.

Tshark –color – wireshark-like colourised output

Tshark –z filter
* Set a filter for specific types. Use –z help for more
  * Focus on a specific protocol
    * Tshark –r demo.pcapng -z io,phs,udp -q

**Statistics**
* Statistics | Packet length
  * Use –z plen,tree –q to view packet lengths tree
    * Tshark –r demo.pcapng -z plen,tree -q
* Statistics | Endpoints - overview unique endpoints and see number of packets associated with each
  * -z endpoints,ip -q
* Statistics | Conversations - overview traffic between two particular points
  * -z conv,ip -q
* Statistics | Expert Info – automatic comments provided by wireshark
  * -z expert -q
* Statistics | IPv4 and IPv6
  * -z ptype,tree –q – summary of hosts
  * -z ip_hosts,tree –q – IPv4 statistics
  * -z ipv6hosts,tree -q - IPv6 statistics
  *  -z ip_srcdst,tree –q – Source and Destination IP Addresses
    *  -z dests,tree –q - IPv4
    *  -z ipv6_dests,tree –q IPv6
* Statistics DNS
  * -z dns,tree -q
* Statistics HTTP
  * -z http,tree –q – packet and status counter for HTTP
  * -z http2,tree –q - HTTP2
  * -z http_srv,tree –q – load distribution
  * -z http_req,tree –q - requests
  * -z http_seq,tree –q – requests and responses
  
**Streams, Objects and Credentials**
* -z follow,tcp,ascii,0 –q – tcp streams
* -z follow,udp,ascii,0 –q - udp streams
* -z follow,http,ascii,0 –q – http streams
* Can filter  packets and follow streams by using the parameters
* tshark –r <.file> --export-objects http,/home/ubuntu/Desktop/extracted-by-tshark
* Can detect and collect cleartext credentials from FTP, HTTP, IMAP, POP and SMTP
  * -z credentials -q
  
**Advanced Filtering**

Contains – search a value inside a packet, case sensitive, similar to Wireshark find option. Comparison operator to search value inside packets similar to Find option.

*Example*
* tshark –r demo.pcapng -Y 'http.server contains "Apache"'
* tshark –r demo.pcapng -Y 'http.server contains "Apache"' -T fields –e ip.src -e ip.dst -e http.server -E header=y

Matches – Search a pattern inside packets, supports regex, case insensitive, complex queries have a margin of error. Search a pattern of a regular expression, like find all .php and .html pages

*Example*
* tshark –r demo.pcapng -Y 'http.request.method matches "(GET|POST)"'
* tshark –r demo.pcapng -Y 'http.request.method matches "(GET|POST)"' -T fields –e ip.src -e ip.dst -e http.request.method -E header=y
* Contains and match operators cannot be used with fields consisting of integer values
* HEX and regex values instead of ASCII have better chance of a match

  • -T – Main Filter 
    ○ -T fields
  • -e – Target Field. Need to use for each field you want to display
    ○ -e ip.src -e ip.dst
  • -E – Show Field Name
    ○ -E header=y

**Looking for time stamps** 

-T fields –e frame.time

Extract Info
* Hostname
  * tshark –r hostnames.pcapng -T fields –e dhcp.option.hostname
  * Extract hostname from DHCP packets, may contain duplicate values. Can use pipes to clear up.

* tshark –r hostnames.pcapng -T fields –e dhcp.option.hostname | awk NF |  sort -r | uniq -c | sort-r
  * Awk NF – remove empty lines
  * Sort –r – sort recursively before handling the values
  * Uniq –c – show unique values, but calculate and show the number of occurences
  * Sort –r – final sort process, show output/results from high to low

**DNS Queries**
* Tshark –r dns-queries.pcap -T fields –e dns.qry.name | awk NF | sort –r | uniq –c | sort –r

**User Agents**
* Tshark –r user-agents.pcap -T fields –e http.user_agent | awk NF | sort –r | uniq –c | sort –r

## Wireshark
